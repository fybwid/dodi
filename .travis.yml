language: ruby
rvm:
- 2.4.0
services:
- postgresql
before_install: gem install bundler
before_script:
- sh -e /etc/init.d/xvfb start
- psql -c "CREATE DATABASE dodi_production;" -U postgres
- psql -c "CREATE DATABASE dodi_test;" -U postgres
- psql -c "CREATE DATABASE dodi_development;" -U postgres
- cp config/database.travis.yml config/database.yml
- export PARALLEL_TEST_PROCESSORS=4
- rake db:reset:setup
deploy:
  provider: heroku
  api_key:
    secure: nLdfXBJkoZ66tOhnLIacwnaa3GVhlFloMbYH3tx0tc8B9PIwG3XTjgAttgedoqfrxrOI7oravBnuiE1qLagV41Adzl9YKxuRGwwzSnLaYlNaunWELDCcGDHTmSgq13WU4m+38CEUnPO+bD384LvShigrukgcgs51Sl+2AVqjBn5LLfPetlnr6kRfqg2wTZ5+tknmo5I/zBuAbOD0OXxY8Ht++v1jBsJROTU16ki4Ex4HUHZxMohwu/UuhZZ0DbZXqlw1SxS7QNBhguG+gdEVZRLBv/UTH83ltlPqMTjPkjQbqUbOotcF6ca2CVnjP++Abgjbg4PsQV0aZ3QkWjRN7cI2gK+sk3C9fgJPq4xzhxcpt+xqdPfNJ6otT9JkfWOx2U6snrpVUulQrEU2dP9KISC4xpOpyuE4MCOuy8sv49W8Nt5FqFM/zjCiF8Ga36Rp0VrNmGb/OPx4Rxdx6Gr/3YBWLVzrswry1SKZsm8fsBeJrgXM4AkGODd2YhTuhM3aRr/rQ1vuci0Ryl47FxQjtCky9U+m8IPDskln41tmShBAbYquNkE4shrprhkct7LJCISu4tWsLbWHLZrL1kp6QImku6QA5rJWR3K+mFH3jBMu80dSTSpzme6lvQZIncBPE6jlUgeUYim1oVmY3BTjhJxN4himLSLeptdk9X7c2qA=
  app: dodi-app
  on:
    repo: fybwid/dodi
