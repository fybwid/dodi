language: ruby
rvm:
- 2.4.0
services:
- postgresql
before_install: gem install bundler
before_script:
- sh -e /etc/init.d/xvfb start
- psql -c "CREATE DATABASE dodi_production;" -U postgres
- psql -c "CREATE DATABASE dodi_test;" -U postgres
- psql -c "CREATE DATABASE dodi_development;" -U postgres
- cp config/database.travis.yml config/database.yml
- export PARALLEL_TEST_PROCESSORS=4
- RAILS_ENV=development bundle exec rake db:create db:migrate
deploy:
  provider: heroku
  api_key:
    secure: JOQ6cUfeYP4cw3S5nLgS0gNeO93MbRE4YQmRtIw6BlQfCYRKHsqU8hTj0UcZlNmbp+hG8tsj5EMVh6r8anM89tjOtROO9ut+NZ8p/OFANBiKjY56Jl3DaksxdZr/sX1aXQ4PKCMxdGmiqEq0N3OS+qECGKVaw+3Lm8pt05a1k4giZE7L1AiUgPWtHqrmmY2NiaYcyrKHub9gTF3X/Gr9xfS1QMGHIQVkJ1vzEJ8JBe0sqL5WpicKYnYPl4TZTeTquIckxcTI+q6+dfEkdm2IWeCSB/BqVuMXAWJZVOQoZA3zZswYsMhyWN8uGTqzbW+ecZr9u5j3RrECeSQR2s/ESi0biNMVNbrBsj0ZiuhoTCaJSx6LLWfJ/JtYNR1ZyzMxtOxdaQHuufcrYQP78G/CcDOPdmIgX+Jb4+laJ1oOeq4FYdKx8TFfykLrT8xiSPedPZzj+4gDLhM0UAPHlFjtZRF+drIGQjmVZk5ppqd+7Bsyovg4WssiFsTbZdJpv21pD9BYQ4m/svcaNVnx3V/27qiDv2GKQ6sRZl0yLzF2fjvgq5sp/kwK5Cbr73id00RM6AFnpM8tAVbAUAGonTNHKr18X80ytCAiPFwhLjmdY+fnLnG2RpVYC6TjMq5Rr3OroLR3BwRLx6Bgoe0m3O43Q05qC4MBQ61dktvr/FITRIc=
  app: dodi
  on:
    repo: fybwid/dodi
